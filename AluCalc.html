<!DOCTYPE html>
<HTML lang="en">

  <HEAD>

    <META charset="UTF-8">
    <META name="viewport" content="width=device-width, initial-scale=1.0"> <!-- scale on phone -->
    <META name="mobile-web-app-capable" content="yes"> <!-- add page to phone homescreen -->

    <!-- <LINK rel="stylesheet" href="style.css"> -->

    <TITLE>ALU calc</TITLE>

    <STYLE>
      body {
        font-family: Arial, Helvetica, sans-serif;
        margin: 10px 6px 2px 6px;
        background-color: FloralWhite; /*Ivory AntiqueWhite*/
      }

      .keys_grid{
        width: 100%;
        display: grid;
        grid-template-columns: repeat(5, 1fr); /* 5 keys in a row, each 1 fractional part */
      }

      .mkey, .skey {
        display: grid;
        margin-left: 6px;
        margin-right: 6px;
        place-items: center;
      }

      .mkey {
        margin-top: 0px;
        margin-bottom: 4px;
        padding: 4px;
        background-color: dimgrey;
        color: white;
        font-weight: 600;
        font-size: 24px;
        border: 2px solid black;
        border-radius: 10px;
      }
      .mkey:hover { background-color: darkgrey; }
      .mkey:active { background-color: green; }

      .skey {
        margin-top: 4px;
        margin-bottom: 0px;
        padding: 0px;
        color: darkorange;
        font-weight: 600;
        font-size: 15px;
      }

      .shift {
        background-color: darkorange;
        border: 2px solid chocolate;
      }
      .shift:hover { background-color: #FFB040; }

      .del, .clr{
        background-color: red;
        border: 2px solid firebrick;
      }
      .del:hover, .clr:hover { background-color: #FF8080; }

      .display, .lflags, .cflags, .rflags {
        display: grid;
        background-color: gainsboro;
        color: dimgrey;
        font-family: "Lucida Console", "Courier New", monospace;
      }

      .display {
        grid-column-start: 1;
        grid-column-end: 6;
        place-items: end;
        margin: 0px 6px 8px 6px;

        padding: 10px 4px 6px 4px;
        font-weight: 600;
        font-size: 32px;

        border-left: 2px solid black;
        border-right: 2px solid black;
        border-bottom: 2px solid black;
      }

      .lflags, .cflags, .rflags {
        place-items: center;
        margin-top: 4px 0px 0px 0px;

        padding: 3px;
        font-weight: 600;
        font-size: 12px;

        border-top: 2px solid black;
      }

      .lflags {
        margin-left: 6px;
        border-left: 2px solid black;
      }

      .rflags {
        margin-right: 6px;
        border-right: 2px solid black;
      }

    </STYLE>

    <SCRIPT>
      var help

      function hit(label) {
        var elem = document.getElementById('flag_op');
        elem.innerHTML = label
        if( label=="key-del" ) {
          var win = window.open("", "ALU calc help" );
          win.document.body.innerHTML = help;
        }
      }

      function hotkeyhandler(event) {
        var buttons = document.getElementsByTagName("button");
        for( var ix=0; ix<buttons.length; ix++ ) {
          const but = buttons[ix];
          const but_id = but.getAttribute("_id");
          const but_key = but.getAttribute("_key");
          if( event.key==but_key ) { hit(but_id); return false; }
        }
        return true; // 'false' means consumed
      }

      function main() {
        document.getElementsByTagName("body")[0].onkeydown = hotkeyhandler;
        var buttons = document.getElementsByTagName("button");
        help = "<TITLE>ALU calc HELP</TITLE><table>\n"
        help += "<META name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n"
        help += "  <tr><td><b>hotkey</b></td><td><b>primary function</b></td><td><b>secondary function</b></td></tr>\n"
        for( var ix=0; ix<buttons.length; ix++ ) {
          const but = buttons[ix];
          const but_id = but.getAttribute("_id");
          const but_key = but.getAttribute("_key");
          const but_helpm = but.getAttribute("_helpm");
          const but_helps = but.getAttribute("_helps");
          // Set the hotkey hint (title)
          but.setAttribute("title", "Hotkey: "+but_key+"\nPrimary function: "+but_helpm+"\nSecondary function: "+but_helps );
          // Set the onclick
          but.addEventListener("click", function(){hit(but_id)} );
          // Extend help
          help += "  <tr><td>"+but_key+"</td><td>"+but_helpm+"</td><td>"+but_helps+"</td></tr>\n";
        }
        help += "</table>\n"
        help += "<b>Note</b>: hotkeys are unshifted on PC keyboard</b>\n" 
      }

      window.onload = main;
    </SCRIPT>

  </HEAD>

  <BODY>

    <DIV class="keys_grid">

      <DIV class="lflags" id="flag_shift">&#8679; LOCK</DIV>
      <DIV class="cflags" id="flag_op">op</DIV>
      <DIV class="cflags" id="flag_width">8 bit</DIV>
      <DIV class="cflags" id="flag_mems">M ABCDEF</DIV>
      <DIV class="rflags" id="flag_cpuflags">O C Z N P</DIV>

      <DIV class="display">FFFF 1893</DIV>

      <DIV class="skey">lock</DIV>
      <DIV class="skey">MS#</DIV>
      <DIV class="skey">MR#</DIV>
      <DIV class="skey" >help</DIV>
      <DIV class="skey">AC</DIV>
      <BUTTON class="mkey shift" _key="z" _id="key-shift" _helpm="shift (select orange function of each key)" _helps="lock shift">&#8679;</BUTTON>
      <BUTTON class="mkey" _key="s" _id="key-ms" _helpm="memory store to M" _helps="memory store to selected memory (A-F)">MS</BUTTON>
      <BUTTON class="mkey" _key="r" _id="key-mr" _helpm="memory recall from M" _helps="memory recall from selected memory (A-F)">MR</BUTTON>
      <BUTTON class="mkey del" _key="Backspace" _id="key-del" _helpm="delete last entry (key)" _helps="pops up a apge with help on AluCalc">DEL</BUTTON>
      <BUTTON class="mkey clr" _key="Escape"  _id="key-clr" _helpm="clear pending computation" _helps="also clear all memories, input mode, width, display mode">C</BUTTON>

      <DIV class="skey"></DIV>
      <DIV class="skey"></DIV>
      <DIV class="skey"></DIV>
      <DIV class="skey">s&gt;&gt;#</DIV>
      <DIV class="skey">NXOR</DIV>
      <BUTTON class="mkey" _key="d" _id="key-digd" _helpm="hexadecimal digit D" _helps="">D</BUTTON>
      <BUTTON class="mkey" _key="e" _id="key-dige" _helpm="hexadecimal digit E" _helps="">E</BUTTON>
      <BUTTON class="mkey" _key="f" _id="key-digf" _helpm="hexadecimal digit F" _helps="">F</BUTTON>
      <BUTTON class="mkey" _key=";" _id="key-asr" _helpm="ASR (arithmetic shift to right, ie with sign extend) by one" _helps="ASR with selected amount">s&gt;&gt;</BUTTON>
      <BUTTON class="mkey" _key="x" _id="key-xor" _helpm="XOR (bitwise exclusive OR)" _helps="bitwise inverse (NOT) of XOR">XOR</BUTTON>

      <DIV class="skey">C&#x2942;</DIV> <!-- 2942 rightwards arrow above short leftwards arrow --> <!-- x21AA right arrow with Hook -->
      <DIV class="skey">&#x2942;#</DIV>
      <DIV class="skey">&#x2942;</DIV>
      <DIV class="skey">&gt;&gt;#</DIV>
      <DIV class="skey">NOR</DIV>
      <BUTTON class="mkey" _key="a" _id="key-diga" _helpm="hexadecimal digit A" _helps="rotate to the right by one through carry">A</BUTTON>
      <BUTTON class="mkey" _key="b" _id="key-digb" _helpm="hexadecimal digit B" _helps="rotate to the right by selected amount">B</BUTTON>
      <BUTTON class="mkey" _key="c" _id="key-digc" _helpm="hexadecimal digit C" _helps="rotate to the right by one">C</BUTTON>
      <BUTTON class="mkey" _key="." _id="key-lsr" _helpm="LSR (logic shift to right, ie with 0 shifted in) by one" _helps="LSR with selected amount">&gt;&gt;</BUTTON>
      <BUTTON class="mkey" _key="o" _id="key-or" _helpm="OR (bitwise OR)" _helps="bitwise inverse (NOT) of OR">OR</BUTTON>

      <DIV class="skey">&#x2944;C</DIV> <!-- 2944 rightwards arrow above short leftwards arrow --> <!-- x21A9 left arrow with Hook -->
      <DIV class="skey">&#x2944;#</DIV>
      <DIV class="skey">&#x2944;</DIV>
      <DIV class="skey">&lt;&lt;#</DIV>
      <DIV class="skey">NAND</DIV>
      <BUTTON class="mkey" _key="7" _id="key-dig7" _helpm="(hexa)decimal digit 7" _helps="rotate to the left by one through carry">7</BUTTON>
      <BUTTON class="mkey" _key="8" _id="key-dig8" _helpm="(hexa)decimal digit 8" _helps="rotate to the left by selected amount">8</BUTTON>
      <BUTTON class="mkey" _key="9" _id="key-dig9" _helpm="(hexa)decimal digit 9" _helps="rotate to the left by one">9</BUTTON>
      <BUTTON class="mkey" _key="," _id="key-lsl" _helpm="LSL (logic shift to left, ie with 0 shifted in) by one" _helps="LSL with selected amount">&lt;&lt;</BUTTON>
      <BUTTON class="mkey" _key="n" _id="key-and" _helpm="AND (exclusive bitwise AND)" _helps="bitwise inverse (NOT) of AND">AND</BUTTON>

      <DIV class="skey"></DIV>
      <DIV class="skey">NIMP</DIV>
      <DIV class="skey">IMP</DIV>
      <DIV class="skey">s×</DIV>
      <DIV class="skey">s÷</DIV>
      <BUTTON class="mkey" _key="4" _id="key-dig4" _helpm="(hexa)decimal digit 4" _helps="">4</BUTTON>
      <BUTTON class="mkey" _key="5" _id="key-dig5" _helpm="(hexa)decimal digit 5" _helps="IMP (bitwise implication)">5</BUTTON>
      <BUTTON class="mkey" _key="6" _id="key-dig6" _helpm="(hexa)decimal digit 6" _helps="bitwise inverse (NOT) of IMP">6</BUTTON>
      <BUTTON class="mkey" _key="\" _id="key-mul" _helpm="multiplication" _helps="signed multiplication">×</BUTTON>
      <BUTTON class="mkey" _key="/" _id="key-div" _helpm="division" _helps="signed division">÷</BUTTON>

      <DIV class="skey"></DIV>
      <DIV class="skey">INC</DIV>
      <DIV class="skey">DEC</DIV>
      <DIV class="skey">+C</DIV>
      <DIV class="skey">−C</DIV>
      <BUTTON class="mkey" _key="1" _id="key-dig1" _helpm="(hexa)decimal or binary digit 1" _helps="">1</BUTTON>
      <BUTTON class="mkey" _key="2" _id="key-dig2" _helpm="(hexa)decimal digit 2" _helps="increment by one">2</BUTTON>
      <BUTTON class="mkey" _key="3" _id="key-dig3" _helpm="(hexa)decimal digit 3" _helps="decrement by one">3</BUTTON>
      <BUTTON class="mkey" _key="=" _id="key-add" _helpm="addition" _helps="addition with carry in">+</BUTTON>
      <BUTTON class="mkey" _key="-" _id="key-sub" _helpm="subtraction" _helps="subtraction with borrow in">−</BUTTON>

      <DIV class="skey">width</DIV>
      <DIV class="skey">NOT</DIV>
      <DIV class="skey">BH</DIV>
      <DIV class="skey">SEC</DIV>
      <DIV class="skey">anser</DIV>
      <BUTTON class="mkey" _key="0" _id="key-dig0" _helpm="(hexa)decimal or binary digit 0" _helps="loops through ALU widths">0</BUTTON>
      <BUTTON class="mkey" _key="`" _id="key-sign" _helpm="2s complement" _helps="bitwise inverse (NOT)">±</BUTTON>
      <BUTTON class="mkey" _key="m" _id="key-mode" _helpm="loop through input modes (binary, hexadecimal, decimal)" _helps="loop through display modes">BHD</BUTTON>
      <BUTTON class="mkey" _key="y" _id="key-carry" _helpm="set carry flag" _helps="clear carry flag">CLC</BUTTON>
      <BUTTON class="mkey" _key="Enter" _id="key-exec" _helpm="complete pending computation" _helps="show history of answers">=</BUTTON>
    </DIV>

  </BODY>
</HTML>